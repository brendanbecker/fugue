{
  "document": {
    "title": "Building ccmux: A Claude Code-Aware Terminal Multiplexer in Rust",
    "source_path": "/home/becker/projects/tools/ccmux/docs/research/claude_research.md",
    "total_lines": 633,
    "estimated_total_tokens": 4500,
    "parsing_metadata": {
      "parsed_at": "2026-01-07",
      "target_chunk_size": "400-900 tokens"
    }
  },
  "sections": [
    {
      "id": "intro",
      "title": "Executive Summary",
      "level": 0,
      "line_range": [1, 5],
      "token_estimate": 180,
      "children": []
    },
    {
      "id": "section-1",
      "title": "Terminal emulation requires three layered components",
      "level": 1,
      "line_range": [7, 97],
      "token_estimate": 750,
      "children": [
        {"id": "section-1.1", "title": "PTY management with portable-pty", "level": 2, "line_range": [11, 45], "token_estimate": 320},
        {"id": "section-1.2", "title": "Terminal state parsing with vt100", "level": 2, "line_range": [47, 67], "token_estimate": 200},
        {"id": "section-1.3", "title": "Rendering at 60fps with Ratatui", "level": 2, "line_range": [69, 84], "token_estimate": 130},
        {"id": "section-1.4", "title": "Recommended crate dependencies", "level": 2, "line_range": [86, 97], "token_estimate": 100}
      ]
    },
    {
      "id": "section-2",
      "title": "Claude Code operates as a closed system with workarounds",
      "level": 1,
      "line_range": [100, 162],
      "token_estimate": 580,
      "children": [
        {"id": "section-2.1", "title": "Visual state detection patterns", "level": 2, "line_range": [104, 112], "token_estimate": 100},
        {"id": "section-2.2", "title": "Structured output via stream-json", "level": 2, "line_range": [114, 129], "token_estimate": 130},
        {"id": "section-2.3", "title": "Session storage and resume mechanics", "level": 2, "line_range": [131, 151], "token_estimate": 200},
        {"id": "section-2.4", "title": "Key environment variables for integration", "level": 2, "line_range": [153, 162], "token_estimate": 100}
      ]
    },
    {
      "id": "section-3",
      "title": "Crash recovery demands hybrid persistence strategies",
      "level": 1,
      "line_range": [165, 246],
      "token_estimate": 680,
      "children": [
        {"id": "section-3.1", "title": "What constitutes terminal state", "level": 2, "line_range": [169, 191], "token_estimate": 180},
        {"id": "section-3.2", "title": "Hybrid checkpoint + WAL strategy", "level": 2, "line_range": [193, 219], "token_estimate": 250},
        {"id": "section-3.3", "title": "Claude session recovery specifically", "level": 2, "line_range": [221, 242], "token_estimate": 180},
        {"id": "section-3.4", "title": "Zellij's approach as reference", "level": 2, "line_range": [244, 246], "token_estimate": 70}
      ]
    },
    {
      "id": "section-4",
      "title": "Prior art reveals architectural patterns worth adopting",
      "level": 1,
      "line_range": [249, 300],
      "token_estimate": 520,
      "children": [
        {"id": "section-4.1", "title": "tmux's battle-tested foundations", "level": 2, "line_range": [253, 261], "token_estimate": 130},
        {"id": "section-4.2", "title": "Zellij's modern Rust architecture", "level": 2, "line_range": [263, 277], "token_estimate": 170},
        {"id": "section-4.3", "title": "Comparison matrix for architecture decisions", "level": 2, "line_range": [279, 288], "token_estimate": 100},
        {"id": "section-4.4", "title": "Recommended ccmux structure", "level": 2, "line_range": [290, 300], "token_estimate": 120}
      ]
    },
    {
      "id": "section-5",
      "title": "Hot-reload configuration requires careful debouncing",
      "level": 1,
      "line_range": [303, 407],
      "token_estimate": 620,
      "children": [
        {"id": "section-5.1", "title": "File watching implementation", "level": 2, "line_range": [307, 346], "token_estimate": 320},
        {"id": "section-5.2", "title": "Categorizing changes for selective application", "level": 2, "line_range": [348, 377], "token_estimate": 180},
        {"id": "section-5.3", "title": "Validation with serde_valid", "level": 2, "line_range": [379, 407], "token_estimate": 120}
      ]
    },
    {
      "id": "section-6",
      "title": "Teaching Claude structured output via skills system",
      "level": 1,
      "line_range": [410, 506],
      "token_estimate": 600,
      "children": [
        {"id": "section-6.1", "title": "Protocol design using namespaced XML", "level": 2, "line_range": [414, 433], "token_estimate": 180},
        {"id": "section-6.2", "title": "SKILL.md definition for ccmux", "level": 2, "line_range": [435, 458], "token_estimate": 170},
        {"id": "section-6.3", "title": "Streaming parser with recovery", "level": 2, "line_range": [460, 491], "token_estimate": 200},
        {"id": "section-6.4", "title": "Nesting recommendation", "level": 2, "line_range": [493, 506], "token_estimate": 50}
      ]
    },
    {
      "id": "section-7",
      "title": "Recursion control requires Erlang-style supervision",
      "level": 1,
      "line_range": [509, 624],
      "token_estimate": 750,
      "children": [
        {"id": "section-7.1", "title": "Depth enforcement across processes", "level": 2, "line_range": [513, 538], "token_estimate": 200},
        {"id": "section-7.2", "title": "Session tree with supervision", "level": 2, "line_range": [540, 564], "token_estimate": 180},
        {"id": "section-7.3", "title": "Erlang OTP supervision strategies for ccmux", "level": 2, "line_range": [566, 573], "token_estimate": 80},
        {"id": "section-7.4", "title": "Resource limits via cgroups", "level": 2, "line_range": [575, 597], "token_estimate": 170},
        {"id": "section-7.5", "title": "Fan-out orchestration pattern", "level": 2, "line_range": [599, 613], "token_estimate": 100},
        {"id": "section-7.6", "title": "Recommended defaults", "level": 2, "line_range": [615, 624], "token_estimate": 80}
      ]
    },
    {
      "id": "conclusion",
      "title": "Conclusion",
      "level": 1,
      "line_range": [627, 633],
      "token_estimate": 220,
      "children": []
    }
  ]
}
